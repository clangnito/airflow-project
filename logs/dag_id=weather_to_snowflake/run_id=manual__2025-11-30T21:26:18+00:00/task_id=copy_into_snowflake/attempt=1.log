{"timestamp":"2025-11-30T21:26:28.530831Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-11-30T21:26:28.531550Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/weather_to_snowflake.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-11-30T21:26:28.873820Z","level":"warning","event":"The `airflow.decorators.task` attribute is deprecated. Please use `'airflow.sdk.task'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/weather_to_snowflake.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2025-11-30T21:26:28.909710Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:28.910138Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:28.910426Z","level":"info","event":"Current task name:copy_into_snowflake","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:28.910877Z","level":"info","event":"Dag name:weather_to_snowflake","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:28.929855Z","level":"info","event":"Snowflake Connector for Python Version: 3.18.0, Python Version: 3.12.12, Platform: Linux-6.12.54-linuxkit-x86_64-with-glibc2.36","logger":"snowflake.connector.connection","filename":"connection.py","lineno":521}
{"timestamp":"2025-11-30T21:26:28.930843Z","level":"info","event":"Connecting to GLOBAL Snowflake domain","logger":"snowflake.connector.connection","filename":"connection.py","lineno":1464}
{"timestamp":"2025-11-30T21:26:30.400093Z","level":"info","event":"Running statement: COPY INTO weather_incremental\n        FROM @airflow_stage/weather_inc_2025-11-30.json\n        FILE_FORMAT = (TYPE = 'JSON')\n        ON_ERROR = 'CONTINUE';, parameters: None","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"snowflake.py","lineno":586}
{"timestamp":"2025-11-30T21:26:30.400434Z","level":"info","event":"Running statement: COPY INTO weather_incremental\n        FROM @airflow_stage/weather_inc_2025-11-30.json\n        FILE_FORMAT = (TYPE = 'JSON')\n        ON_ERROR = 'CONTINUE';, parameters: None","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"sql.py","lineno":810}
{"timestamp":"2025-11-30T21:26:30.542132Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"ProgrammingError","exc_value":"002019 (0A000): 01c0bec6-0001-766e-0000-0001c3564f3d: SQL compilation error:\nJSON file format can produce one and only one column of type variant, object, or array. Load data into separate columns using the MATCH_BY_COLUMN_NAME copy option or copy with transformation.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":252,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/weather_to_snowflake.py","lineno":81,"name":"copy_into_snowflake"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/snowflake/hooks/snowflake.py","lineno":587,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":818,"name":"_run_command"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/cursor.py","lineno":1134,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":286,"name":"errorhandler_wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":341,"name":"hand_to_other_handler"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":217,"name":"default_errorhandler"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-11-30T21:26:30.568874Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:30.569389Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:30.569912Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): copy_into_snowflake>","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:30.570178Z","level":"info","event":"Failure caused by 002019 (0A000): 01c0bec6-0001-766e-0000-0001c3564f3d: SQL compilation error:","logger":"task.stdout"}
{"timestamp":"2025-11-30T21:26:30.570423Z","level":"info","event":"JSON file format can produce one and only one column of type variant, object, or array. Load data into separate columns using the MATCH_BY_COLUMN_NAME copy option or copy with transformation.","logger":"task.stdout"}
