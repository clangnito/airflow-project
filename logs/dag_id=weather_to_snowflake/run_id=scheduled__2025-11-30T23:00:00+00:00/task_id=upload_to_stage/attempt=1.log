{"timestamp":"2025-11-30T22:32:26.498852Z","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager","filename":"manager.py","lineno":179}
{"timestamp":"2025-11-30T22:32:26.506141Z","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/weather_to_snowflake.py","logger":"airflow.models.dagbag.DagBag","filename":"dagbag.py","lineno":593}
{"timestamp":"2025-11-30T22:32:27.335177Z","level":"warning","event":"The `airflow.decorators.task` attribute is deprecated. Please use `'airflow.sdk.task'`.","category":"DeprecatedImportWarning","filename":"/opt/airflow/dags/weather_to_snowflake.py","lineno":2,"logger":"py.warnings"}
{"timestamp":"2025-11-30T22:32:27.384972Z","level":"info","event":"Task instance is in running state","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:27.385510Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:27.386105Z","level":"info","event":"Current task name:upload_to_stage","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:27.386537Z","level":"info","event":"Dag name:weather_to_snowflake","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:27.431243Z","level":"info","event":"Snowflake Connector for Python Version: 3.18.0, Python Version: 3.12.12, Platform: Linux-6.12.54-linuxkit-x86_64-with-glibc2.36","logger":"snowflake.connector.connection","filename":"connection.py","lineno":521}
{"timestamp":"2025-11-30T22:32:27.432668Z","level":"info","event":"Connecting to GLOBAL Snowflake domain","logger":"snowflake.connector.connection","filename":"connection.py","lineno":1464}
{"timestamp":"2025-11-30T22:32:29.665504Z","level":"info","event":"Running statement: PUT file:///opt/airflow/logs/data/weather/weather_inc_2025-11-30.json\n        @airflow_stage\n        AUTO_COMPRESS=FALSE\n        OVERWRITE=TRUE;, parameters: None","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"snowflake.py","lineno":586}
{"timestamp":"2025-11-30T22:32:29.665847Z","level":"info","event":"Running statement: PUT file:///opt/airflow/logs/data/weather/weather_inc_2025-11-30.json\n        @airflow_stage\n        AUTO_COMPRESS=FALSE\n        OVERWRITE=TRUE;, parameters: None","logger":"airflow.task.hooks.airflow.providers.snowflake.hooks.snowflake.SnowflakeHook","filename":"sql.py","lineno":810}
{"timestamp":"2025-11-30T22:32:31.048974Z","level":"error","event":"An exception was raised in <bound method SnowflakeStorageClient.prepare_upload of <snowflake.connector.s3_storage_client.SnowflakeS3RestClient object at 0x7fbcfbe90dd0>>","logger":"snowflake.connector.file_transfer_agent","filename":"file_transfer_agent.py","lineno":631,"error_detail":[{"exc_type":"HTTPError","exc_value":"403 Client Error: Forbidden for url: https://sfc-fra-ds1-16-customer-stage.s3.amazonaws.com/bgbb1000-s/stages/6c0a8f98-cf67-438e-9ef9-450021f76f1c/weather_inc_2025-11-30.json","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/file_transfer_agent.py","lineno":628,"name":"function_and_callback_wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/storage_client.py","lineno":228,"name":"prepare_upload"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/storage_client.py","lineno":194,"name":"preprocess"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/s3_storage_client.py","lineno":428,"name":"get_file_header"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/vendored/requests/models.py","lineno":1026,"name":"raise_for_status"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-11-30T22:32:31.126298Z","level":"error","event":"Task failed with exception","logger":"task","filename":"task_runner.py","lineno":1002,"error_detail":[{"exc_type":"OperationalError","exc_value":"253003: 253003: While putting file(s) there was an error: 'HTTPError('403 Client Error: Forbidden for url: https://sfc-fra-ds1-16-customer-stage.s3.amazonaws.com/bgbb1000-s/stages/6c0a8f98-cf67-438e-9ef9-450021f76f1c/weather_inc_2025-11-30.json')', this might be caused by your access to the blob storage provider, or by Snowflake.","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":928,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1315,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":252,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":416,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":213,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":236,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":82,"name":"run"},{"filename":"/opt/airflow/dags/weather_to_snowflake.py","lineno":67,"name":"upload_to_stage"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/snowflake/hooks/snowflake.py","lineno":587,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/common/sql/hooks/sql.py","lineno":818,"name":"_run_command"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/cursor.py","lineno":1088,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/file_transfer_agent.py","lineno":782,"name":"result"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":286,"name":"errorhandler_wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":341,"name":"hand_to_other_handler"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/snowflake/connector/errors.py","lineno":217,"name":"default_errorhandler"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-11-30T22:32:31.217002Z","level":"info","event":"Task instance in failure state","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:31.217741Z","level":"info","event":"Task start","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:31.218344Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): upload_to_stage>","logger":"task.stdout"}
{"timestamp":"2025-11-30T22:32:31.218985Z","level":"info","event":"Failure caused by 253003: 253003: While putting file(s) there was an error: 'HTTPError('403 Client Error: Forbidden for url: https://sfc-fra-ds1-16-customer-stage.s3.amazonaws.com/bgbb1000-s/stages/6c0a8f98-cf67-438e-9ef9-450021f76f1c/weather_inc_2025-11-30.json')', this might be caused by your access to the blob storage provider, or by Snowflake.","logger":"task.stdout"}
